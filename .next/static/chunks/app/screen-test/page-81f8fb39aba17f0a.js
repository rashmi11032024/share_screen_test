(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[96],{5020:function(e,r,s){Promise.resolve().then(s.bind(s,5418))},5418:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return g}});var t,a,n=s(7437),o=s(2265),l=s(9376);(t=a||(a={})).IDLE="idle",t.REQUESTING="requesting",t.GRANTED="granted",t.CANCELLED="cancelled",t.DENIED="denied",t.ERROR="error";var i=s(6615);let c=()=>{let[e,r]=(0,o.useState)(a.IDLE),[s,t]=(0,o.useState)(null),[n,l]=(0,o.useState)(null),[c,d]=(0,o.useState)(null),[u,m]=(0,o.useState)(!1),g=(0,o.useRef)(!0),h=e=>{i.k.debug("Extracting display type from track");let r=e.getSettings();i.k.debug("Track settings:",r);let s=r.displaySurface;return"monitor"===s?"monitor":"window"===s?"window":"browser"===s?"browser":(i.k.warn("Unknown display surface type:",s),"unknown")},x=(0,o.useCallback)(e=>{i.k.group("Extracting stream metadata");let r=e.getVideoTracks()[0];if(!r)throw i.k.error("No video track found in stream"),i.k.groupEnd(),Error("No video track found");let s=r.getSettings(),t={displayType:h(r),width:s.width||0,height:s.height||0,frameRate:s.frameRate||0};return i.k.info("Stream metadata extracted:",t),i.k.groupEnd(),t},[]),p=(0,o.useCallback)(e=>{if(!e){i.k.debug("No stream to cleanup");return}i.k.group("Cleaning up stream");let r=e.getTracks();i.k.debug("Stopping ".concat(r.length," track(s)")),r.forEach((e,r)=>{i.k.debug("Stopping track ".concat(r+1,": ").concat(e.kind," - ").concat(e.label)),e.stop()}),i.k.info("Stream cleanup complete"),i.k.groupEnd()},[]),b=(0,o.useCallback)(()=>{if(i.k.warn("Stream ended - user stopped sharing or browser ended stream"),!g.current){i.k.debug("Component unmounted, skipping state updates");return}m(!1),r(a.IDLE),t(null),l(null),i.k.info("State reset after stream end")},[]),f=(0,o.useCallback)(async()=>{i.k.group("Requesting screen share"),i.k.info("User initiated screen share request"),d(null),r(a.REQUESTING);try{i.k.debug("Calling getDisplayMedia API");let e=await navigator.mediaDevices.getDisplayMedia({video:{frameRate:{ideal:30}},audio:!1});i.k.info("Screen share permission granted"),i.k.debug("Stream obtained:",{id:e.id,active:e.active,trackCount:e.getTracks().length});let s=x(e),n=e.getVideoTracks()[0];n&&(i.k.debug("Setting up onended listener for video track"),n.onended=()=>{i.k.warn("Video track ended event fired"),b()}),g.current?(r(a.GRANTED),t(e),l(s),m(!0),i.k.info("Screen share started successfully")):(i.k.warn("Component unmounted during request, cleaning up stream"),p(e)),i.k.groupEnd()}catch(e){if(i.k.group("Screen share request failed"),i.k.error("Error occurred:",e),!g.current){i.k.debug("Component unmounted, skipping error handling"),i.k.groupEnd();return}"NotAllowedError"===e.name?e.message.includes("cancelled")||e.message.includes("dismiss")?(i.k.warn("User cancelled the screen picker"),r(a.CANCELLED)):(i.k.warn("Permission denied by user or system"),r(a.DENIED)):"NotFoundError"===e.name?(i.k.error("No screen/window/tab was selected"),r(a.CANCELLED)):"NotSupportedError"===e.name?(i.k.error("Screen sharing not supported"),r(a.ERROR)):"AbortError"===e.name?(i.k.warn("Request was aborted"),r(a.CANCELLED)):(i.k.error("Unknown error occurred"),r(a.ERROR)),d(e),m(!1),i.k.groupEnd()}},[x,b,p]),k=(0,o.useCallback)(()=>{if(i.k.info("Manual stop screen share requested"),!s){i.k.warn("No active stream to stop");return}p(s),g.current&&(m(!1),r(a.IDLE),t(null),l(null),i.k.info("Screen share stopped successfully"))},[s,p]);return(0,o.useEffect)(()=>(i.k.debug("useScreenShare hook mounted"),()=>{i.k.debug("useScreenShare hook unmounting - cleaning up"),g.current=!1,s&&p(s)}),[s,p]),{permissionState:e,stream:s,metadata:n,error:c,isActive:u,requestScreenShare:f,stopScreenShare:k}};var d=s(5523);let u=e=>{let{stream:r,metadata:s}=e,t=(0,o.useRef)(null);(0,o.useEffect)(()=>(i.k.debug("StreamPreview: Setting up video element"),t.current&&r&&(i.k.debug("StreamPreview: Attaching stream to video element"),t.current.srcObject=r,t.current.play().catch(e=>{i.k.error("StreamPreview: Error playing video",e)})),()=>{i.k.debug("StreamPreview: Cleaning up video element"),t.current&&(t.current.srcObject=null)}),[r]);let a={monitor:"Entire Screen",window:"Application Window",browser:"Browser Tab",unknown:"Unknown Source"};return(0,n.jsxs)("div",{className:"w-full max-w-4xl mx-auto space-y-4",children:[(0,n.jsx)("div",{className:"flex items-center justify-center gap-2",children:(0,n.jsxs)("div",{className:"flex items-center gap-2 bg-green-100 text-green-800 px-4 py-2 rounded-full",children:[(0,n.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),(0,n.jsx)("span",{className:"font-semibold",children:"Screen Stream Active"})]})}),(0,n.jsxs)("div",{className:"relative bg-black rounded-lg overflow-hidden shadow-2xl",children:[(0,n.jsx)("video",{ref:t,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-auto"}),(0,n.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/80 to-transparent p-4",children:(0,n.jsxs)("div",{className:"text-white text-sm space-y-1",children:[(0,n.jsxs)("p",{className:"font-semibold",children:["\uD83D\uDCFA ",a[s.displayType]]}),(0,n.jsxs)("p",{className:"opacity-90",children:["\uD83D\uDCD0 Resolution: ",s.width," \xd7 ",s.height]}),(0,n.jsxs)("p",{className:"opacity-90",children:["\uD83C\uDFAC Frame Rate: ",s.frameRate," fps"]})]})})]}),(0,n.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"Stream Information"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[(0,n.jsxs)("div",{className:"bg-white p-3 rounded",children:[(0,n.jsx)("p",{className:"text-gray-600 font-medium",children:"Display Type"}),(0,n.jsx)("p",{className:"text-gray-900 font-semibold",children:a[s.displayType]})]}),(0,n.jsxs)("div",{className:"bg-white p-3 rounded",children:[(0,n.jsx)("p",{className:"text-gray-600 font-medium",children:"Resolution"}),(0,n.jsxs)("p",{className:"text-gray-900 font-semibold",children:[s.width," \xd7 ",s.height]})]}),(0,n.jsxs)("div",{className:"bg-white p-3 rounded",children:[(0,n.jsx)("p",{className:"text-gray-600 font-medium",children:"Frame Rate"}),(0,n.jsxs)("p",{className:"text-gray-900 font-semibold",children:[s.frameRate," fps"]})]})]})]}),(0,n.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,n.jsxs)("p",{className:"text-sm text-yellow-900",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Note:"})," This is a local preview only. No recording or backend streaming is happening."]})})]})},m=e=>{let{permissionState:r,error:s}=e;if(r===a.IDLE||r===a.GRANTED)return null;let t={[a.REQUESTING]:{title:"Requesting Permission",message:"Please select a screen, window, or tab to share in the browser dialog.",icon:"\uD83D\uDD04",bgColor:"bg-blue-50",borderColor:"border-blue-200",textColor:"text-blue-900"},[a.CANCELLED]:{title:"Screen Sharing Cancelled",message:'You cancelled the screen selection. Click "Retry" to try again.',icon:"❌",bgColor:"bg-gray-50",borderColor:"border-gray-200",textColor:"text-gray-900"},[a.DENIED]:{title:"Permission Denied",message:"Screen sharing permission was denied. Please check your browser settings and try again.",icon:"\uD83D\uDEAB",bgColor:"bg-red-50",borderColor:"border-red-200",textColor:"text-red-900"},[a.ERROR]:{title:"Error Occurred",message:(null==s?void 0:s.message)||"An unknown error occurred while requesting screen share.",icon:"⚠️",bgColor:"bg-orange-50",borderColor:"border-orange-200",textColor:"text-orange-900"}}[r];return t?(0,n.jsx)("div",{className:"".concat(t.bgColor," ").concat(t.borderColor," ").concat(t.textColor," border rounded-lg p-6 max-w-2xl mx-auto"),children:(0,n.jsxs)("div",{className:"flex items-start gap-4",children:[(0,n.jsx)("div",{className:"text-4xl flex-shrink-0",children:t.icon}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h3",{className:"text-lg font-bold mb-2",children:t.title}),(0,n.jsx)("p",{className:"text-sm opacity-90",children:t.message}),s&&r===a.ERROR&&(0,n.jsxs)("div",{className:"mt-3 p-3 bg-white/50 rounded border border-current/20",children:[(0,n.jsxs)("p",{className:"text-xs font-mono",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Error Name:"})," ",s.name]}),(0,n.jsxs)("p",{className:"text-xs font-mono mt-1",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Details:"})," ",s.message]})]})]})]})}):null};function g(){let e=(0,l.useRouter)(),{permissionState:r,stream:s,metadata:t,error:g,isActive:h,requestScreenShare:x,stopScreenShare:p}=c();(0,o.useEffect)(()=>(i.k.info("ScreenTestPage mounted"),()=>{i.k.info("ScreenTestPage unmounted")}),[]);let b=async()=>{i.k.info('User clicked "Start Screen Capture" button'),await x()},f=async()=>{i.k.info('User clicked "Retry Screen Test" button'),await x()},k=()=>{i.k.info('User clicked "Back to Home" button'),e.push("/")},w=r===a.IDLE||r===a.CANCELLED||r===a.DENIED||r===a.ERROR,N=r===a.REQUESTING;return(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4 md:p-8",children:(0,n.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,n.jsxs)("div",{className:"text-center mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:"Screen Sharing Test"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Test your browser's screen sharing capabilities"})]}),(0,n.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-6 md:p-8 space-y-6",children:[(0,n.jsx)(m,{permissionState:r,error:g}),w&&(0,n.jsxs)("div",{className:"text-center space-y-6",children:[(0,n.jsx)("div",{className:"text-6xl mb-4",children:"\uD83C\uDFA5"}),(0,n.jsxs)("div",{className:"max-w-xl mx-auto",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Ready to Test Screen Sharing"}),(0,n.jsx)("p",{className:"text-gray-600 mb-6",children:"Click the button below to request screen sharing permission. You'll be able to select which screen, window, or tab to share."})]}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsx)(d.z,{onClick:b,disabled:N,loading:N,fullWidth:!0,children:N?"Opening Screen Picker...":"Start Screen Capture"}),(0,n.jsx)(d.z,{onClick:k,variant:"secondary",fullWidth:!0,children:"← Back to Home"})]}),r===a.IDLE&&(0,n.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mt-6",children:[(0,n.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"What will happen:"}),(0,n.jsxs)("ul",{className:"text-sm text-gray-700 text-left space-y-1.5 max-w-md mx-auto",children:[(0,n.jsxs)("li",{className:"flex gap-2",children:[(0,n.jsx)("span",{children:"•"}),(0,n.jsx)("span",{children:"Your browser will show a screen picker dialog"})]}),(0,n.jsxs)("li",{className:"flex gap-2",children:[(0,n.jsx)("span",{children:"•"}),(0,n.jsx)("span",{children:"Select which screen/window/tab to share"})]}),(0,n.jsxs)("li",{className:"flex gap-2",children:[(0,n.jsx)("span",{children:"•"}),(0,n.jsx)("span",{children:"Grant permission to start screen sharing"})]}),(0,n.jsxs)("li",{className:"flex gap-2",children:[(0,n.jsx)("span",{children:"•"}),(0,n.jsx)("span",{children:"View a live preview of your shared screen"})]})]})]})]}),h&&s&&t&&(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)(u,{stream:s,metadata:t}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[(0,n.jsx)(d.z,{onClick:()=>{i.k.info('User clicked "Stop Screen Sharing" button'),p()},variant:"danger",children:"Stop Screen Sharing"}),(0,n.jsx)(d.z,{onClick:k,variant:"secondary",children:"Back to Home"})]}),(0,n.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:(0,n.jsxs)("p",{className:"text-sm text-gray-700 text-center",children:[(0,n.jsx)("span",{className:"font-semibold",children:"Tip:"}),' You can also stop sharing by clicking the browser\'s "Stop sharing" button or closing the shared tab/window.']})})]})]}),!h&&r===a.IDLE&&null===s&&null!==g&&(0,n.jsxs)("div",{className:"mt-6 bg-white rounded-2xl shadow-xl p-6 md:p-8 text-center space-y-6",children:[(0,n.jsx)("div",{className:"text-6xl mb-4",children:"✋"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Screen Sharing Stopped"}),(0,n.jsx)("p",{className:"text-gray-600",children:"The screen sharing session has ended. You can start a new test or return to the homepage."})]}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 justify-center max-w-md mx-auto",children:[(0,n.jsx)(d.z,{onClick:f,fullWidth:!0,children:"Retry Screen Test"}),(0,n.jsx)(d.z,{onClick:k,variant:"secondary",fullWidth:!0,children:"Back to Home"})]})]}),!1]})})}},5523:function(e,r,s){"use strict";s.d(r,{z:function(){return a}});var t=s(7437);s(2265);let a=e=>{let{children:r,onClick:s,variant:a="primary",disabled:n=!1,type:o="button",fullWidth:l=!1,loading:i=!1}=e;return(0,t.jsx)("button",{type:o,onClick:s,disabled:n||i,className:"".concat("px-6 py-3 rounded-lg font-semibold transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"," ").concat({primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500 active:bg-blue-800",secondary:"bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-500 active:bg-gray-400",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 active:bg-red-800"}[a]," ").concat(l?"w-full":""),children:i?(0,t.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[(0,t.jsxs)("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,t.jsx)("span",{children:r})]}):r})}},9376:function(e,r,s){"use strict";var t=s(5475);s.o(t,"useRouter")&&s.d(r,{useRouter:function(){return t.useRouter}})},6615:function(e,r,s){"use strict";s.d(r,{k:function(){return a}});class t{formatMessage(e,r){for(var s=arguments.length,t=Array(s>2?s-2:0),a=2;a<s;a++)t[a-2]=arguments[a];let n=new Date().toISOString(),o="".concat(this.prefix," [").concat(n,"] [").concat(e.toUpperCase(),"] ").concat(r);switch(e){case"error":console.error(o,...t);break;case"warn":console.warn(o,...t);break;case"debug":this.isDebugEnabled&&console.log(o,...t);break;default:console.log(o,...t)}}info(e){for(var r=arguments.length,s=Array(r>1?r-1:0),t=1;t<r;t++)s[t-1]=arguments[t];this.formatMessage("info",e,...s)}warn(e){for(var r=arguments.length,s=Array(r>1?r-1:0),t=1;t<r;t++)s[t-1]=arguments[t];this.formatMessage("warn",e,...s)}error(e){for(var r=arguments.length,s=Array(r>1?r-1:0),t=1;t<r;t++)s[t-1]=arguments[t];this.formatMessage("error",e,...s)}debug(e){for(var r=arguments.length,s=Array(r>1?r-1:0),t=1;t<r;t++)s[t-1]=arguments[t];this.formatMessage("debug",e,...s)}group(e){console.group("".concat(this.prefix," ").concat(e))}groupEnd(){console.groupEnd()}constructor(){this.prefix="[ScreenShare]",this.isDebugEnabled=!0}}let a=new t}},function(e){e.O(0,[971,117,744],function(){return e(e.s=5020)}),_N_E=e.O()}]);